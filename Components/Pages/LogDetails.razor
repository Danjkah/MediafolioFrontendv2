@page "/logDetails/{logId:int}"
@using MediafolioFrontend.Services
@using MediafolioFrontend.Models
@using MediafolioFrontend.Enums
@rendermode InteractiveServer
@inject ILogService logService
@inject NavigationManager navigation


<PageTitle>Your Daily Log</PageTitle>

    @if (isLoading)
    {
        <div class="text-center my-5">
            <div class="spinner-border" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <p class="mt-3">Loading Video details...</p>
        </div>
        
    }


    @if (logDetails != null && !isLoading)
    {
    <button class = "btn btn-outline-secondary mb-3" @onclick="() => GoBack(logDetails.MediaObjectId)">
        ‚Üê Back to Logs 
    </button>
        <h1 class="display-6">Your Daily Log Created at @logDetails.CreatedAt </h1>
        <div class = "row">

        <hr />
               <div>
                <p class = "font-monospace text-body-secondary"> @(logDetails.Content)</p>
               </div>
        
        </div>
    }
    

@code
{
    [Parameter]
    public int logId {get;set;} = int.MaxValue;

    private DailyLogs? logDetails = null;

    private bool isLoading = false;

    private string? errorMessage = null;


    private async Task LoadLogDetails(){
        try{
            isLoading = true;
            errorMessage = null;
            if (int.MaxValue == logId)
            {
                errorMessage = "Invalid movie ID.";
                return;
            }            

            logDetails = await logService.GetDailyLogById(logId);
            Console.WriteLine(logDetails.Content);

            if (logDetails == null)
            {
                errorMessage = "something went wrong while getting the video details, try again";
            }

        }catch(Exception ex)
        {
            errorMessage = ex.Message; 
        }finally
        {
            isLoading = false; 
        }
    }


    protected override async Task OnInitializedAsync()
    {
        await LoadLogDetails(); 
    }

    private void GoBack(int mediaId)
    {

        navigation.NavigateTo($"/logs/{mediaId}");

    }
}